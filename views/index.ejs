<!DOCTYPE html>
<html>
  <head>
    <title>ToDo List</title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
  </head>
  <body>
    
    <h1>ToDo List</h1>
    <button onclick="addParam(`?onlyToDo=true`)" class="filters">Show only To-do</button>
    <a href="/" class="filters">Show all tasks</a>
    <table>
      <thead>
        <!-- href="/?sortBy=name&sortOrder==='asc'" -->
        <tr>
          <th>Task <button onclick="addParam(`sortBy=name&sortOrder==='asc'`)"><img src="/images/ordenar.png" alt="order" class="order" data-sort-by="name" ></button></th>
          <th>Limit Date <button onclick="addParam(`?sortBy=date&sortOrder==='asc'`)"><img src="/images/ordenar.png" alt="order" class="order" data-sort-by="date" ></button></th>
          <th>Status <button onclick="addParam(`?sortBy=status&sortOrder==='asc'`)"><img src="/images/ordenar.png" alt="order" class="order" data-sort-by="status" ></button></th>
          <th>Actions</th> 
        </tr>
      </thead>
      <tbody>
        <% if (!tasks || tasks.length == 0) { %>
          <tr>
            <td colspan="4">There's any tasks included!</td>
          </tr>
        <% } else { %>
          <% tasks.forEach((task) => { %>
              <tr class="<%= task.status === false ? 'completed' : '' %>">
                <td><a href="/taskView/<%= task.id %>"><%= task.name %></a></td>
                <td class="<%= task.date < today ? 'late' : '' %>"><%= format(task.date, 'dd/MM/yyyy') %></td>
                <td><%= task.status === true ? 'To do' : 'Completed' %></td>
                <td class="<%= task.status === false ? 'completedAction' : '' %> actionsSec">
                  <% if (task.status === true) { %>
                    <abbr title="Edit task">
                      <a href="/taskEdit/<%= task.id %>" class="noLine" >
                        <img src="/images/edit.png" alt="Edit" class="actions update"/>
                      </a>
                    </abbr>
                    <abbr title="Delete task">
                      <a href="/delete/<%= task.id %>" class="noLine" onclick="return confirm('Deseja realmente excluir a Tarefa?')">
                        <img src="/images/trash.png" alt="Delete"  class="actions delete"/>
                      </a>
                    </abbr>
                    <abbr title="Finish task">
                      <a href="/taskComplete/<%= task.id %>" class="noLine" onclick="return confirm('Deseja finalizar a tarefa?')">
                        <img src="/images/check.png" alt="Finish" class="actions finish"/>
                      </a>
                    </abbr>
                  <% } %>
                </td>
              </tr>
          <% }) %>
        <% } %>
      </tbody>
    </table>
    <a href="/taskInsert" class="addTask">Add Task</a>
  </body>
  <script>
    var urlBase = "<%= urlParams %>";
    // console.log(teste); // Isso imprimir√° "Hello from backend!" no console
  </script>
  <script src="/javascripts/script.js"></script>
</html>
